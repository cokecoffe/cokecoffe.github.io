---
layout: "post"
title: "App Update"
date: "2018-05-08 18:01"
categories: AppTeam
---

传统的App版本升级控制是在服务端数据库里直接写入了App版本信息的数据，每次升级都需直接修改数据，容易误操作；不利于维护；没有丰富的可配置信息；

针对这些问题，对App升级检测方案进行了优化调整。

### 可配置项

- 配置生效时间：决定了此升级方案有效的下发时间

- 提示次数、间隔：决定App在一定时间范围内的最大提醒次数、间隔

- 升级方式（强制/推荐）：可控制App是否是强制更新

- 弹窗主题（颜色）：App端可根据此颜色配置版本提示框的颜色

- 下发范围（IP）：可指定此升级配置对哪些设备生效

- 安装包地址：用于指定最新的升级包地址

- 最新版本号：用于判断版本号

- 版本更新文案：

### API设计

```
{
  "version": "1.2.8",//最新版本号
  "validIP": {//灰度下发，指定有效网段
    "fromIP": "192.168.1.1",
    "toIP": "192.168.2.200"
  },
  "isForce": 0,//是否是强制更新
  "timeInterval": "5",//非强制更新下提醒升级的间隔
  "information": [//更新文案
    "1.内容",
    "2.内容"
  ],
  "themeColor": "0xffffff",//提示框主题颜色
  "packageUrl": "https://xxx.com/pasq.apk"//升级包或商店的地址
}
```

### 使用方法

  1. 配置升级信息源
  2. 启动升级检测服务
